# ----------------------------------------------------------------------------
# Compiler and Environment Setting
# ----------------------------------------------------------------------------
CC = gcc
LINKER = gcc

CP = cp -rfv
CD = cd
RM = rm -rfv
ECHO = echo

Q = @

# ----------------------------------------------------------------------------
# Sub Makefile Setting
# ----------------------------------------------------------------------------
TOP_DIR = $(PWD)
TASK_DIR = $(TOP_DIR)/task-06


# ----------------------------------------------------------------------------
# Target List
# ----------------------------------------------------------------------------
all: task-clean task-build rootfs-copy buildroot-build

task-build:
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(Q) $(ECHO) " TASK BUILD"
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(CD) $(TASK_DIR) && $(MAKE)

task-clean:
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(Q) $(ECHO) " TASK CLEAN"
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(CD) $(TASK_DIR) && $(MAKE) clean

rootfs-copy:
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(Q) $(ECHO) " ROOTFS BUILD"
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(CD) $(TASK_DIR) && $(MAKE)
	$(RM) $(ROOTFS_DIR)/root/*
	$(CP) $(TASK_DIR)/*.ko           $(ROOTFS_DIR)/root/	

buildroot-build:
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(Q) $(ECHO) " BUILDROOT BUILD"
	$(Q) $(ECHO) "------------------------------------------------------------"
	$(CD) $(TASK_DIR) && $(MAKE)
	make -C $(BUILDROOT_DIR)


